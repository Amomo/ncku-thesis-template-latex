%
% This file is part of ncku-thesis-template.
%
% ncku-thesis-template is distributed in the hope of usefuling to someone,
% you can redistribute it and/or modify
% it under the terms of the Attribution-NonCommercial-ShareAlike
% 4.0 International.
%
% You should have received a copy of the
% Attribution-NonCommercial-ShareAlike 4.0 International
% along with ncku-thesis-template.
%
% If not, see <http://creativecommons.org/licenses/by-nc-sa/4.0/legalcode.txt>.
%

% ----------------------------------------------------------------------------

\DeclareDocumentCommand{\SetTableCaptionAndLabel}{+m +m}
{%
  \ifthenelse{\equal{#1}{\empty}}{}%
  {%
    \caption{#1}%
    \ifthenelse{\equal{#2}{\empty}}%
    {}%
    {\label{#2}}%
  }%
} % End of \DeclareDocumentCommand{}

\DeclareDocumentCommand{\SetTableCaptionStarAndLabel}{+m +m}
{%
  \ifthenelse{\equal{#1}{\empty}}{}%
  {%
    \caption*{#1}%
    \ifthenelse{\equal{#2}{\empty}}%
    {}%
    {\label{#2}}%
  }%
} % End of \DeclareDocumentCommand{}

\newcommand{\DisplayTableContent}[4]
{
  \ifthenelse{\equal{#1}{0.0}}%
  {%
    \begin{minipage}[c]{\textwidth}
    \colorbox{white}{\makebox[\textwidth]{%
      \setlength{\tabcolsep}{#2}%
      \renewcommand{\arraystretch}{#3}%
      #4}}
    \end{minipage}
  }{%
    \begin{minipage}[c]{\textwidth}
    \colorbox{white}{\makebox[\textwidth]{%
    \resizebox{#1\paperwidth}{!}{%
      \setlength{\tabcolsep}{#2}%
      \renewcommand{\arraystretch}{#3}%
      #4}}}
    \end{minipage}
  }%
} % End of \newcommand{}

\pgfkeys
{
  /InsertTable/.is family, /InsertTable,
  default/.style =
  {
    scale = 0.0,
    nomtitle = \empty, % For nomenclature
    caption = \empty,
    label = \empty,
    pos = top, % Position of caption or nomtitle
    tabcolsep = 6pt,
    arraystretch = 1,
  },
  scale/.estore in = \TmpValueScale,
  nomtitle/.estore in = \TmpValueNomTitle,
  caption/.estore in = \TmpValueCaption,
  label/.estore in = \TmpValueLabel,
  pos/.estore in = \TmpValuePosition,
  tabcolsep/.estore in = \TmpValueTabColSep,
  arraystretch/.estore in = \TmpValueArrayStretch,
} % End of \pgfkeys{}

\newcommand{\InsertTable}[2][\empty]
{
  % Parse the input
  \pgfkeys{/InsertTable, default, #1}%
  %
  \begin{table}[H]%
    \colorbox{white}{\makebox[\textwidth]{%
    \begin{minipage}[c]{\textwidth}%
  %
    \ifthenelse{\equal{\TmpValuePosition}{top}}%
    {%
      \ifthenelse{\equal{\TmpValueNomTitle}{\empty}}%
      {\SetTableCaptionAndLabel{\TmpValueCaption}{\TmpValueLabel}}%
      {\SetTableCaptionStarAndLabel{\TmpValueNomTitle}{\TmpValueLabel}}%
      \DisplayTableContent{\TmpValueScale}{\TmpValueTabColSep}{\TmpValueArrayStretch}{#2}%
    }{%
      \DisplayTableContent{\TmpValueScale}{\TmpValueTabColSep}{\TmpValueArrayStretch}{#2}%
      \ifthenelse{\equal{\TmpValueNomTitle}{\empty}}%
      {\SetTableCaptionAndLabel{\TmpValueCaption}{\TmpValueLabel}}%
      {\SetTableCaptionStarAndLabel{\TmpValueNomTitle}{\TmpValueLabel}}%
    }%
    \end{minipage}
    }}%
  \end{table}
} % End of \newcommand{}

% -----------------------------------------------------------------

\newcolumntype{L}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{C}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{R}[1]{>{\raggedleft\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}

%\newcolumntype{LT}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}p{#1}}
%\newcolumntype{LC}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
%\newcolumntype{LB}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}b{#1}}

%\newcolumntype{CT}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}p{#1}}
%\newcolumntype{CC}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
%\newcolumntype{CB}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}b{#1}}

%\newcolumntype{RT}[1]{>{\raggedleft\let\newline\\\arraybackslash\hspace{0pt}}p{#1}}
%\newcolumntype{RC}[1]{>{\raggedleft\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
%\newcolumntype{RB}[1]{>{\raggedleft\let\newline\\\arraybackslash\hspace{0pt}}b{#1}}

% -----------------------------------------------------------------

