
% Some common helper function

% ----------------------------------------------------------------------------

% Some helper functions

\newcommand{\GetMonthInEng}[1]
{
  \ifthenelse{\equal{#1}{1}}{January}{}
  \ifthenelse{\equal{#1}{2}}{February}{}
  \ifthenelse{\equal{#1}{3}}{March}{}
  \ifthenelse{\equal{#1}{4}}{April}{}
  \ifthenelse{\equal{#1}{5}}{May}{}
  \ifthenelse{\equal{#1}{6}}{June}{}
  \ifthenelse{\equal{#1}{7}}{July}{}
  \ifthenelse{\equal{#1}{8}}{August}{}
  \ifthenelse{\equal{#1}{9}}{September}{}
  \ifthenelse{\equal{#1}{10}}{October}{}
  \ifthenelse{\equal{#1}{11}}{November}{}
  \ifthenelse{\equal{#1}{12}}{December}{}
} % End of \newcommand{}

% 計算出台灣民國幾年
% Get the year using Taiwans' year
\newcommand{\SetOralTaiwanYear}[1]
{
  \FPeval{\OralTaiwanYearResult}{clip(#1 - 1911)}
} % End of \newcommand{}

% 計算出台灣民國幾年
% Get the year using Taiwans' year
\newcommand{\SetThesisTaiwanYear}[1]
{
  \FPeval{\ThesisTaiwanYearResult}{clip(#1 - 1911)}
} % End of \newcommand{}

% ----------------------------------------------------------------------------


\newcommand{\BeginThesis}[0]
{
  % Start of paper
  \begin{document}

  % Set the line spacing for whole thesis
  \baselineskip = 26pt
} % End of \newcommand{}

\newcommand{\EndThesis}[0]
{
  % End of paper
  \end{document}
} % End of \newcommand{}

% ----------------------------------------------------------------------------

\newcommand{\StartNewPage}
{
  % Page start
  \newpage
  \phantomsection
} % End of \newcommand{}

\newcommand{\EndOfPage}
{
  % End of page
  \clearpage
} % End of \newcommand{}

% ----------------------------------------------------------------------------

% Abstract
\newcommand{\StartAbstract}
{
  \StartNewPage

  % Add to "Table of Contents"
  \addcontentsline{toc}{chapter}{Abstract}

  % Title
  \centerline{\Large \textbf{Abstract}}
} % End of \newcommand{}

\def \EndChiAbstract
{
  % Keyword
  \AbstractKeyword

  \EndOfPage
} % End of \def{}

\def \EndAbstract
{
  % Keyword
  \ExtendedAbstractKeyword

  \EndOfPage
} % End of \def{}

% Extended Abstract
\newcommand{\StartExtendedAbstract}
{
  \StartNewPage

  % Set page
  \baselineskip=20pt
  \setlength{\parindent}{0.0pt}

  % Set style
  \pagestyle{empty}

  % 設定段落之間的距離
  \setlength{\parskip}{0.5cm}

  % Add to "Table of Contents"
  \addcontentsline{toc}{chapter}{Extended Abstract}

  % Add title
  \centerline{\large \textbf{\eTitle}}
  \vspace{0.5cm}

  % Add name
  \centerline{\large \GetAuthorEngName}

  % Add names
  \centerline{\large Prof. \thinspace \GetAdvisorEngNameA}
  \ifthenelse{\equal{\GetAdvisorEngNameB}{\empty}}
    {}
    {\centerline{\large Prof. \thinspace \GetAdvisorEngNameB}}

  \ifthenelse{\equal{\GetAdvisorEngNameC}{\empty}}
    {}
    {\centerline{\large Prof. \thinspace \GetAdvisorEngNameC}}

  % Add department
  \centerline{\large \GetDeptEngName}
} % End of \newcommand{}

\def \EndExtendedAbstract
{
  \EndOfPage

  % 設定段落之間的距離
  \setlength{\parskip}{0.3cm}

  % Reset page
  \setlength{\parindent}{1.5em}
  \baselineskip=26pt

  % Re-set style
  \pagestyle{plain}
} % End of \def{}

% Summary in Extended Abstract
\newcommand{\ExtAbstractSummary}[1]{
  \begin{framed}
    \ExtAbstractChapter{SUMMARY}{#1}

    % Keyword
    \ExtendedAbstractKeyword
  \end{framed}
} % End of \newcommand{}

% Chapter in Extended Abstract
\newcommand{\ExtAbstractChapter}[2]
{
  \vspace{0.4cm}
  \centerline{\textbf{#1}}

  #2
} % End of \newcommand{}

% Sub-chapter in Extended Abstract
\newcommand{\ExtAbstractSubChapter}[2]
{
  \textbf{#1}

  #2
} % End of \newcommand{}

\newcommand{\AbstractKeyword}[0]
{
  % Keyword
  \par
  \ifthenelse{\equal{\GetKeywordsE}{\empty}}
  {
    \ifthenelse{\equal{\GetKeywordsD}{\empty}}
    {
      \ifthenelse{\equal{\GetKeywordsC}{\empty}}
      {
        \ifthenelse{\equal{\GetKeywordsB}{\empty}}
        {
          \ifthenelse{\equal{\GetKeywordsA}{\empty}}
          {}
          {
            {\noindent \bf 關鍵字:} \GetKeywordsA
          } % End of else{}
        } % End of if{}
        {
          {\noindent \bf 關鍵字:} \GetKeywordsA, \GetKeywordsB
        } % End of else{}
      } % End of if{}
      {
        {\noindent \bf 關鍵字:} \GetKeywordsA, \GetKeywordsB, \GetKeywordsC
      } % End of else{}
    } % End of if{}
    {
      {\noindent \bf 關鍵字:} \GetKeywordsA, \GetKeywordsB, \GetKeywordsC, \GetKeywordsD
    } % End of else{}
  } % End of if{}
  {
    {\noindent\bf 關鍵字:} \GetKeywordsA, \GetKeywordsB, \GetKeywordsC, \GetKeywordsD, \GetKeywordsE
  } % End of else{}
} % End of \newcommand{}

\newcommand{\ExtendedAbstractKeyword}[0]
{
  % Keyword
  \par
  \ifthenelse{\equal{\GetKeywordsE}{\empty}}
  {
    \ifthenelse{\equal{\GetKeywordsD}{\empty}}
    {
      \ifthenelse{\equal{\GetKeywordsC}{\empty}}
      {
        \ifthenelse{\equal{\GetKeywordsB}{\empty}}
        {
          \ifthenelse{\equal{\GetKeywordsA}{\empty}}
          {}
          {
            {\noindent \bf Key words:} \GetKeywordsA
          } % End of else{}
        } % End of if{}
        {
          {\noindent \bf Key words:} \GetKeywordsA, \GetKeywordsB
        } % End of else{}
      } % End of if{}
      {
        {\noindent \bf Key words:} \GetKeywordsA, \GetKeywordsB, \GetKeywordsC
      } % End of else{}
    } % End of if{}
    {
      {\noindent \bf Key words:} \GetKeywordsA, \GetKeywordsB, \GetKeywordsC, \GetKeywordsD
    } % End of else{}
  } % End of if{}
  {
    {\noindent\bf Key words:} \GetKeywordsA, \GetKeywordsB, \GetKeywordsC, \GetKeywordsD, \GetKeywordsE
  } % End of else{}
} % End of \newcommand{}

% ----------------------------------------------------------------------------

% Chapters
\DeclareDocumentCommand{\StartChapter}{m g}
{
  \chapter{#1}
  \IfNoValueF{#2}{\label{#2}}
%  \baselineskip=26pt
%  \thispagestyle{empty}
} % End of \DeclareDocumentCommand{}

\def \EndChapter {\EndOfPage}

% Acknowledgments
\newcommand{\StartAcknowledgments}[1]
{
  \StartNewPage

  % Add to "Table of Contents"
  \addcontentsline{toc}{chapter}{Acknowledgments}

  % Title
  \centerline{\Large \textbf{Acknowledgments}}

  \IfNoValueF{#1}{\label{#1}}
} % End of \newcommand{}

\def \EndAcknowledgments {\EndOfPage}

\def \StartAppendix
{
  \StartNewPage
  % Appendix begins here (For one appendix chapter only)
  %\cleardoublepage
  \appendix
  %\clearpage
  %\setcounter{page}{\thepage}
  % If more than one appendix chapters
  %\appendices
}

\def \EndAppendix {\EndOfPage}

% ----------------------------------------------------------------------------

% --- Chinese / English title 中英文論文題目 ---
\newcommand{\KeywordsA}{} % Default
\newcommand{\KeywordsB}{} % Default
\newcommand{\KeywordsC}{} % Default
\newcommand{\KeywordsD}{} % Default
\newcommand{\KeywordsE}{} % Default
\newcommand{\SetKeywordsA}[1]{\renewcommand{\KeywordsA}{#1}}
\newcommand{\SetKeywordsB}[1]{\renewcommand{\KeywordsB}{#1}}
\newcommand{\SetKeywordsC}[1]{\renewcommand{\KeywordsC}{#1}}
\newcommand{\SetKeywordsD}[1]{\renewcommand{\KeywordsD}{#1}}
\newcommand{\SetKeywordsE}[1]{\renewcommand{\KeywordsE}{#1}}
\newcommand{\GetKeywordsA}[0]{\KeywordsA}
\newcommand{\GetKeywordsB}[0]{\KeywordsB}
\newcommand{\GetKeywordsC}[0]{\KeywordsC}
\newcommand{\GetKeywordsD}[0]{\KeywordsD}
\newcommand{\GetKeywordsE}[0]{\KeywordsE}
\DeclareDocumentCommand{\SetKeywords}{
  m G{\empty} G{\empty} G{\empty} G{\empty}}
{
  \SetKeywordsA{#1}
  \ifthenelse{\equal{#2}{\empty}}{}{\SetKeywordsB{#2}}
  \ifthenelse{\equal{#3}{\empty}}{}{\SetKeywordsC{#3}}
  \ifthenelse{\equal{#4}{\empty}}{}{\SetKeywordsD{#4}}
  \ifthenelse{\equal{#5}{\empty}}{}{\SetKeywordsE{#5}}
} % End of \newcommand{}

% ----------------------------------------------------------------------------

