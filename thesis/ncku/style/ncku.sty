%
% This file is part of ncku-thesis-template.
%
% ncku-thesis-template is distributed in the hope of usefuling to someone,
% you can redistribute it and/or modify
% it under the terms of the Attribution-NonCommercial-ShareAlike
% 4.0 International.
%
% You should have received a copy of the
% Attribution-NonCommercial-ShareAlike 4.0 International
% along with ncku-thesis-template.
%
% If not, see <http://creativecommons.org/licenses/by-nc-sa/4.0/legalcode.txt>.
%
% ------------------------------------------------
%
% 台灣國立成功大學(NCKU)碩博士排版設定
%
% 基礎於陳朝鈞老師所提供的 'utdiss.sty', 並在2015年9月4號重新修改.
% 有關修改內容可參考 <https://github.com/wengan-li/ncku-thesis-template-latex> 中
% v1.3.0的ChangeLog.
%
% 原生自utdiss.sty
% utdiss.sty --- Version 2.1.1 (April 1992)
% Doctoral Dissertation Format Macros for The Univ. of Texas at Austin
%     By Young U. Ryu
%     Modified by Glenn G. Lai for LaTeX2e (May 1995)
%
% ------------------------------------------------

% 頁面邊界

% 國立成功大學各系(所)博碩士撰寫論文須知102.5.14日101學年第2次教務會議通過
% 論文封面及內頁紙張規格:寬21 公分,長29.6 公分(即A4 尺寸)80 磅模造紙。
% 封面邊界: 直式:上2.3cm、下3cm、左2cm、右2cm
% 內頁邊界: 直式:上2.3cm、下3.5cm(含頁碼)、左2.5cm、右3cm

% 預設邊界為: 內頁邊界
\usepackage{geometry}
\geometry{a4paper,
  paperwidth=21cm,paperheight=29.6cm,
  top=2.3cm,bottom=3.5cm,left=2.5cm,right=3cm,
  nohead}

% API用來 '開始使用' 和 '停止使用' 封面邊界
\newcommand{\EnableCoverPageStyle}{
  \newgeometry{
  top=2.3cm,bottom=3cm,left=2cm,right=2cm,
  nohead,nofoot}
} % End of \newcommand{}
\newcommand{\DisableCoverPageStyle}{\restoregeometry}

% ------------------------------------------------

% 預設前幾頁的頁碼是用羅馬數字
\pagenumbering{roman}

% ------------------------------------------------

% Move in by 0.05in on both left and right
%\oddsidemargin 0.38in \evensidemargin 0.7in
%\textwidth 5.65in
%\textwidth 5.5in

% Move in by 0.05in on both top and bottom
%\topmargin .05in
%\topmargin 0.35in
%\headheight -0.2in
%\headsep 0.0in   % \headheight + \headsep = 0.5in

%\textheight 8.15in % \textheight does not include \footskip
%\textheight 8.9in % \textheight does not include \footskip
%\footskip 0.9in
%\skip\footins 22.8pt plus 4pt minus 2pt
%\parindent .2in
%\parskip 5 pt plus 1.5pt minus .5pt
%\itemsep 0 pt plus .5pt

% ------------------------------------------------

\newlength{\regular@textheight}
\newlength{\short@textheight}
\setlength{\regular@textheight}{\textheight}
\setlength{\short@textheight}{\textheight}
%\addtolength{\short@textheight}{-\footskip}

\def\short@page{%
    \setlength{\textheight}{\short@textheight}
    \@colht\textheight
    \@colroom\textheight
    \vsize\textheight}
\def\regular@page{%
    \setlength{\textheight}{\regular@textheight}
    \@colht\textheight
    \@colroom\textheight
    \vsize\textheight}


\newcounter{regular@short}
\begin{comment}
\let\old@opcol\@opcol
\def\@opcol{%
    \ifnum\value{regular@short}=0\regular@page\old@opcol
    \else\short@page\old@opcol\fi}
\end{comment}

\begin{comment}
%
% Macros to set spacing of texts and quotations
%                          ^^^^^ ^^^ ^^^^^^^^^^
\def\single@space{%
    \vskip\baselineskip
    \baselineskip=15.5pt plus .5pt minus .2pt
    \vskip-\baselineskip}
\def\endsingle@space{\par}

\def\onehalf@space{%
    \vskip\baselineskip
    \baselineskip=20.5pt plus .5pt minus .2tp
    \vskip-\baselineskip}
\def\endonehalf@space{\par}

\def\double@space{%
    \vskip\baselineskip
    \baselineskip=23pt plus .5pt minus .2pt
    \vskip-\baselineskip}
\def\enddouble@space{\par}

\def\special@space{%
    \vskip\baselineskip
    \baselineskip=21.5pt plus .5pt minus .2pt
    \vskip-\baselineskip}
\def\endspecial@space{\par}

% Spacing for quotations
\let\old@quote\quote
\let\endold@quote\endquote
\let\old@quotation\quotation
\let\endold@quotation\endquotation

\def\singlespacequote{%
    \def\quote{\old@quote\single@space}
    \def\endquote{\endsingle@space\endold@quote}
    \def\quotation{\old@quotation\single@space}
    \def\endquotation{\endsingle@space\endold@quotation}}

\def\onehalfspacequote{%
    \def\quote{\old@quote\onehalf@space}
    \def\endquote{\endonehalf@space\endold@quote}
    \def\quotation{\old@quotation\onehalf@space}
    \def\endquotation{\endonehalf@space\endold@quotation}}
\end{comment}
% Regular text spacing
\def\doublespacing{%
    \def\default@spacing{\baselineskip=20pt plus .5pt minus .2pt}}
\def\onehalfspacing{%
    \def\default@spacing{\baselineskip=20.5pt plus .5pt minus .2pt}}
\def\singlespacing{%
    \def\default@spacing{\baselineskip=15.5pt plus .5pt minus .2pt}}
\def\specialspacing{%
    \def\default@spacing{\baselineskip=21.5pt plus .5pt minus .2pt}}
\begin{comment}
%
% Macros to adjust the shape of table of contents.
% Adopted from macros of Stefan Timphus that do not indent
%      entries properly when content lines are long.
% Modified by Young U. Ryu so that entries are correctly indented.
% If there are 10 or more sections,
%              10 or more subsections for a section, etc. etc.
% enter `\longtocentry' somewhere before `\begin{document}'.
%
\newlength{\one@num}\setlength{\one@num}{0pt}  % 1.5em  % indent of \section
\newlength{\two@num}\settowidth{\two@num}{9.9...}
\newlength{\three@num}\settowidth{\three@num}{9.9.9...}
\newlength{\four@num}\settowidth{\four@num}{9.9.9.9...}
\newlength{\five@num}\settowidth{\five@num}{9.9.9.9.9...}
\newlength{\six@num}\settowidth{\six@num}{9.9.9.9.9.9...}

\def\longtocentry{%
    \newlength{\two@num}\settowidth{\two@num}{99.99...}
    \newlength{\three@num}\settowidth{\three@num}{99.99.99...}
    \newlength{\four@num}\settowidth{\four@num}{99.99.99.99...}
    \newlength{\five@num}\settowidth{\five@num}{99.99.99.99.99...}
    \newlength{\six@num}\settowidth{\six@num}{99.99.99.99.99.99...}}

\newlength{\c@onenum}
    \setlength{\c@onenum}{\one@num}
\newlength{\c@twonum}
    \setlength{\c@twonum}{\c@onenum}\addtolength{\c@twonum}{\two@num}
\newlength{\c@threenum}
    \setlength{\c@threenum}{\c@twonum}\addtolength{\c@threenum}{\three@num}
\newlength{\c@fournum}
    \setlength{\c@fournum}{\c@threenum}\addtolength{\c@fournum}{\four@num}
\newlength{\c@fivenum}
    \setlength{\c@fivenum}{\c@fournum}\addtolength{\c@fivenum}{\five@num}

\def\l@section{\@dottedtocline{1}{\c@onenum}{\two@num}}
\def\l@subsection{\@dottedtocline{2}{\c@twonum}{\three@num}}
\def\l@subsubsection{\@dottedtocline{3}{\c@threenum}{\four@num}}
\def\l@paragraph{\@dottedtocline{4}{\c@fournum}{\five@num}}
\def\l@subparagraph{\@dottedtocline{5}{\c@fivenum}{\six@num}}

% A modified version of `\addcontentsline' of `latex.tex'.
% Do not place page numbers in the table of content.
\def\nopage@addcontentsline#1#2#3{\if@filesw \begingroup
\let\label\@gobble \let\index\@gobble \let\glossary\@gobble
\def\protect##1{\string\string\string##1\string\space
    \space}\@temptokena{}%
\edef\@tempa{\write \@auxout{\string\@writefile{#1}{%
    \protect\contentsline{#2}{#3}{\the\@temptokena}}}}%
    \@tempa\if@nobreak \ifvmode\nobreak\fi\fi\endgroup\fi}

% Stolen from `report.sty'
% Modified to change the size of left skip
%     for \chapter title which is longer than one line
\newlength{\toc@chap@indent}
\settowidth{\toc@chap@indent}{\bf\@chapapp\space\thechapter.\hspace*{1em}}
\def\l@chapter#1#2{\addpenalty{-\@highpenalty}
    \vskip 1.0em plus 1pt
    \@tempdima=\toc@chap@indent
    \begingroup
    \parindent \z@
    \rightskip \@pnumwidth
    \parfillskip -\@pnumwidth
    \bf \leavevmode
    \advance\leftskip\@tempdima \hskip -\leftskip #1\nobreak\hfil
    \nobreak\hbox to\@pnumwidth{\hss #2}\par
    \penalty\@highpenalty \endgroup}
\end{comment}

\if \GetChapterTitleLang \VarChapterTitleLangChi
  \def\@makechapterhead#1{ \vspace*{0pt} {\parindent 0pt \centering
      \ifnum \c@secnumdepth >\m@ne \Large\bf 第\zhnumber{\thechapter}章
      \par \vskip 15pt \fi \Large \bf #1\par \nobreak \vskip 35pt}}
\else
  \def\@makechapterhead#1{ \vspace*{0pt} {\parindent 0pt \centering
      \ifnum \c@secnumdepth >\m@ne \Large\bf \@chapapp{} \thechapter
      \par \vskip 15pt \fi \Large \bf #1\par \nobreak \vskip 35pt}}
\fi

\def\@makeschapterhead#1{\vspace*{0pt} {\parindent 0pt \centering
    \Large \bf #1\par \nobreak \vskip 30pt}}

\def\chapter{%
    \clearpage
    \stepcounter{AppendixCounter}
    \short@page \setcounter{regular@short}{0} %<<--
    \default@spacing
    \global\@topnum\z@ \@afterindentfalse %\@afterindenttrue
    \secdef\@chapter\@schapter}

\def\shortchapter{%
    \clearpage
    \short@page \setcounter{regular@short}{1} %<<--
    \default@spacing
    \global\@topnum\z@ \@afterindentfalse %\@afterindenttrue
    \secdef\@chapter\@schapter}


\newcount\chap@or@app\chap@or@app=1

\def\appendixname{Appendix}

\newcounter{AppendixCounter}

\def\appendix{\clearpage
%    \typeout{Appendix.}
%    \thispagestyle{plain}
%    \vspace*{\fill}
%    \centerline{\large\bf Appendix}
%    \vspace*{\fill}
%    \addcontentsline{toc}{chapter}{Appendix}
%    \setcounter{chapter}{0}
%    \setcounter{section}{0}
    \setcounter{AppendixCounter}{0}
    \def\@chapapp{\appendixname}
    \chap@or@app=2
    \def\thechapter{\Alph{AppendixCounter}}}

\def\appendices{\clearpage
%    \typeout{Appendices.}
%    \thispagestyle{plain}
%    \vspace*{\fill}
%    \centerline{\large\bf Appendices}
%    \vspace*{\fill}
%    \nopage@addcontentsline{toc}{chapter}{Appendices}
%    \setcounter{chapter}{0}
%    \setcounter{section}{0}
    \setcounter{AppendixCounter}{0}
    \def\@chapapp{\appendixname}
    \chap@or@app=2
    \def\thechapter{\Alph{AppendixCounter}}}

\def\@chapter[#1]#2{
  \if \GetChapterTitleLang \VarChapterTitleLangEng
    \ifnum \c@secnumdepth >\m@ne
        \refstepcounter{chapter}
        \typeout{\@chapapp\space\thechapter.}
        \addcontentsline{toc}{chapter}{\@chapapp\space\thechapter.\hspace*{1em}#1}
    \else
        \addcontentsline{toc}{chapter}{#1}
    \fi
  \else
    \ifnum \c@secnumdepth >\m@ne
        \refstepcounter{chapter}
        \typeout{第\thechapter 章.}
        \addcontentsline{toc}{chapter}{第\thechapter 章.\hspace*{1em}#1}
    \else
        \addcontentsline{toc}{chapter}{#1}
    \fi
  \fi
    \chaptermark{#1}
    \addtocontents{lof}{\protect\addvspace{10pt}}
    \addtocontents{lot}{\protect\addvspace{10pt}}
    \@makechapterhead{#2} \@afterheading
    \ifnum\chap@or@app=1\ifnum\value{chapter}=1         % if Chapter 1
        \markboth{}{}\pagestyle{plain}
        \pagenumbering{arabic}\fi\fi
        \thispagestyle{plain}}

%%% Stolen from latex.tex (to unindent the first para of (sub)sections)
%\def\@startsection#1#2#3#4#5#6{\if@noskipsec \leavevmode \fi
%   \par \@tempskipa #4\relax
%   \@afterindentfalse
%   \if@nobreak \everypar{}
%   \else\addpenalty{\@secpenalty}\addvspace{\@tempskipa}\fi
%   \@ifstar{\@ssect{#3}{#4}{#5}{#6}}%
%           {\@dblarg{\@sect{#1}{#2}{#3}{#4}{#5}{#6}}}}

%%% Restored from latex.ltx--Glenn G. Lai
\def\@startsection#1#2#3#4#5#6{\if@noskipsec \leavevmode \fi
   \par \@tempskipa #4\relax
   \@afterindenttrue
   \ifdim \@tempskipa <\z@
     \@tempskipa -\@tempskipa \@afterindentfalse
   \fi
   \if@nobreak \everypar{}\else
     \addpenalty{\@secpenalty}\addvspace{\@tempskipa}\fi \@ifstar
     {\@ssect{#3}{#4}{#5}{#6}}%
     {\@dblarg{\@sect{#1}{#2}{#3}{#4}{#5}{#6}}}}

 \def\section{\@startsection{section}{1}{\z@}%
    {4.6ex plus -1ex minus -.2ex}{.3ex plus .2ex}{\bf}}
\def\subsection{\@startsection{subsection}{2}{\z@}%
    {3.9ex plus -1ex minus -.2ex}{.2ex plus .2ex}{\bf}}
\def\subsubsection{\@startsection{subsubsection}{3}{\z@}%
    {3.25ex plus -1ex minus -.2ex}{.1ex plus .2ex}{\bf}}
 
% --------------------------

% 目錄

\def\tableofcontents{%
    \chapter*{\VarIndexTitleText}
    \addcontentsline{toc}{chapter}{\VarIndexTitleText}
    \pagestyle{plain}
    \baselineskip=15pt plus .5pt minus .5pt
    \@starttoc{toc}}

\def\listoffigures{%
    \chapter*{\VarTablesIndexTitleText}
    \addcontentsline{toc}{chapter}{\VarTablesIndexTitleText}
    \pagestyle{plain}
    \baselineskip=15pt plus .5pt minus .5pt
    \@starttoc{lof}}

\def\listoftables{%
    \chapter*{\VarFiguresIndexTitleText}
    \addcontentsline{toc}{chapter}{\VarFiguresIndexTitleText}
    \pagestyle{plain}
    \baselineskip=15pt plus .5pt minus .5pt
    \@starttoc{lot}}

% --------------------------

% Default lines space is following English style format 
\UseEngLinesSpacing
